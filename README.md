# Face_Reacognition_SNN
I have explained the complete project and related theory in my article  https://mahesh-chat.medium.com/face-recognition-system-using-siamese-neural-network-130a50aedccf .I have explained how we can solve computer vision problems or we can also say Convolutional Neural Network problems using Siamese Neural Network.So, here i have implemented face recogniton with siamese neural network.Deep Convolutional Neural Networks have become the state of the art methods for image classification tasks. However, one of the biggest limitations is they require a lots of labelled data. In many applications, collecting this much data is sometimes not feasible. One Shot Learning aims to solve this problem and One Shot Learning is implemented using Siamese neural network.



Problem statement :-
Assume that we want to build face recognition system for a small organization with only 10 employees (small numbers keep things simple). Using a traditional classification approach, we might come up with a system that looks as below:
![1_A49puFRGzvHjRJJBHTxryg](https://user-images.githubusercontent.com/46081668/117581977-6c0ea880-b11d-11eb-8059-d0cb64f9fd8c.jpeg)


Problems :
a) To train such a system, we first require a lot of different images of each of the 10 persons in the organization which might not be feasible. (Imagine if you are doing this for an organization with thousands of employees).
b) What if a new person joins or leaves the organization? You need to take the pain of collecting data again and re-train the entire model again. This is practically not possible specially for large organizations where recruitment and attrition is happening almost every week.
Solution :
Instead of directly classifying an input(test) image to one of the 10 people in the organization, this network instead takes an extra reference image of the person as input and will produce a similarity score denoting the chances that the two input images belong to the same person. Typically the similarity score is squished between 0 and 1 using a sigmoid function; wherein 0 denotes no similarity and 1 denotes full similarity. Any number between 0 and 1 is interpreted accordingly.
Notice that this network is not learning to classify an image directly to any of the output classes. Rather, it is learning a similarity function, which takes two images as input and expresses how similar they are.
![1_g-561DsAfbU6gcVEk9AC4g](https://user-images.githubusercontent.com/46081668/117581987-8183d280-b11d-11eb-86c7-0c645e9e2db7.jpeg)


a) In a short while we will see that to train this network, you do not require too many instances of a class and only few are enough to build a good model.


b) But the biggest advantage is that , let's say in case of face recognition, we have a new employee who has joined the organization. Now in order for the network to detect his face, we only require a single image of his face which will be stored in the database. Using this as the reference image, the network will calculate the similarity for any new instance presented to it. Thus we say that network predicts the score in one shot.






Dataset :-
Custom dataset can be generated by two ways :-
a) By adding a folder of images of the person , you want to recognise
b)By running the dataset generator function in project files. It will create 50 sample from the web camera .





Working :-
Firstly, we make our database of the faces which we want to recognise. This will be a directory named images. To do this, different functions are defined based on the users requirements. . A pre processing pipeline is involved before saving the image to database. While recognising faces, a frame (which contains a face) is taken from webcam and fed into our network. The network takes in the camera frame and database, compares the similarities and differences between each set of frame and database image. The output will be a string which is the name of the most likely similar image in the database. If the face is not found in the database, the output will be a unknown.







Details of files used in this project :- 
1. face functions.py contains a preprocessing pipeline and some other essential functions.
2. add_to_database.py takes a frame from the webcam and saves in the images directory (database)
3. face_cutter.py extracts a face from an image and saves in database.
4. face_recogniser.py main file which recognises faces.5. 
5. fr_utils.py contains some important functions for Inception network.
6. inception_network.py contains Inception network blocks
7. weights cointains weights of pre-trained Inception network
8. haarcascade_frontalface_default.xml for detecting faces.





Steps to install :- 
1. Clone the repository :- https://github.com/mahesh-chat/Face_Reacognition_SNN.git
2. Move to directory Face_Reacognition_SNN :- cd Face-Recognition
3. Install all the dependencies :- pip install requirements.txt
4. To add a face from webcam to database :- python add_to_database.py
5. To run the Face-recognition system :-  python face_recogniser.py



Results :- 

![Screenshot 2021-05-08 021450](https://user-images.githubusercontent.com/46081668/117582118-0c64cd00-b11e-11eb-85a3-8bc9edccdecb.png)




Conclusion :- 
we have seen implementation of facial recognition model in Python, using pre-trained FaceNet model and similarity distance measure between images.
There are several possibilities for improving the model:


1.Poor quality cameras/images limit the model's effectiveness. By combining our facial recognition model with image enhancement techniques to deblur/recover pixel intensity.


2.Small size images make facial recognition more difficult. To help with this, we could upsample the input image to improve its resolution before passing it through the model.
